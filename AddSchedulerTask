# Create folder C:\Windows\Temp\Scripts\
$ScriptPath = "C:\Windows\Temp\Scripts\"
if (Test-Path $ScriptPath) {
    Write-Output "OK"
}
else
{
    New-Item $ScriptPath -ItemType Directory
}

$TMaskScript = "TMaskScript.ps1"
if (Test-Path $TMaskScript) {
    Copy-Item "TMaskScript.ps1" -Destination $ScriptPath
}


# Add new task to scheduler Task

$Trigger= New-ScheduledTaskTrigger `
    -Once `
    -At (Get-Date) `
    -RepetitionInterval (New-TimeSpan -Minutes 30) # Specify the trigger settings
$User= "NT AUTHORITY\SYSTEM" # Specify the account to run the script
$Action= New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-ExecutionPolicy Bypass -File 'C:\Windows\Temp\Scripts\TMaskScript.ps1'" # Specify what program to run and with its parameters
Register-ScheduledTask -TaskName "MonitorTMaskPL" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest â€“Force # Specify the name of the task
